import{e as a,A as e,B as s,f as l,c as u,w as t,d as i,o,a as r,g as c,h as p,F as n,p as d,C as v,l as m,j as f}from"./index-CTVgZndQ.js";import{_ as g}from"./uni-load-more.DtMAAWGf.js";import{_,e as w,d as j,f as y,r as z}from"./uni-app.es.CwYrt2Mn.js";import{_ as N}from"./uni-icons.B3m6PdPA.js";import{r as b}from"./index.BT6q2I3C.js";import{u as h}from"./picList.DDpk1LV3.js";import{a as S}from"./user.CdigAdIn.js";const T=_({__name:"categoryList",setup(_){const T=a({pageNum:1,pageSize:9});w((({id:a,type:s,name:l,Total:u=-1,keyword:t})=>{e({title:l}),T.value.classid=a,T.value.type=s,T.value.keyword=t,-1!=u&&(x.value=+u),A()}));let k=null;const x=a(0),L=a(!1);j((()=>{T.value.pageNum*T.value.pageSize>=x.value||(k&&clearTimeout(k),k=setTimeout((()=>{T.value.pageNum+=1,A(T.value)}),500))})),y((()=>{C.clear()}));const P=a([]);s(P,(()=>{T.value.pageNum*T.value.pageSize>=x.value&&(L.value=!0)}));const C=h();async function A(){if(T.value.classid){const a=await(({classid:a,pageNum:e=1,pageSize:s=9})=>b({url:"/wallList",data:{classid:a,pageNum:e,pageSize:s}}))(T.value);x.value=a.data.total,P.value=[...P.value,...a.data.data]}else if(T.value.type){const a=await S(T.value);P.value=[...P.value,...a.data.data]}else{const a=await(a=>b({url:"/searchWall",data:{...a}}))(T.value);x.value=a.data.total,P.value=[...P.value,...a.data.data]}P.value.forEach((a=>{a.bigPic=a.smallPicurl.replace(/_small.webp/,".jpg")})),C.set(P.value)}return(a,e)=>{const s=m,_=f,w=i,j=z(l("uni-load-more"),g),y=z(l("uni-icons"),N);return o(),u(w,{class:"container"},{default:t((()=>[r(w,{class:"content"},{default:t((()=>[(o(!0),c(n,null,p(P.value,((a,e)=>(o(),u(_,{class:"pic",id:a._id,url:`/pages/sub/preview/preview?index=${e}`},{default:t((()=>[r(s,{src:a.smallPicurl},null,8,["src"])])),_:2},1032,["id","url"])))),256))])),_:1}),0!=P.value.length?(o(),u(j,{key:0,status:L.value?"noMore":"more"},null,8,["status"])):d("",!0),r(w,{class:"goTop",onClick:e[0]||(e[0]=a=>{v({scrollTop:0})})},{default:t((()=>[r(y,{type:"arrow-up",size:"30"})])),_:1})])),_:1})}}},[["__scopeId","data-v-52672eb3"]]);export{T as default};
